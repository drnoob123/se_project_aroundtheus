!function(){"use strict";class e{constructor(e,t,s,r,i,o){let{name:n,link:l,isLiked:a,_id:d,userId:c,ownerId:u}=e;this._name=n,this._link=l,this._likes=a,this._id=d,this._userId=c,this._ownerId=u,this._myId=t,this._cardSelector=s,this._handleCardClick=r,this._handleDeleteClick=i,this._handleLikeClick=o}getId(){return this._id}_getData(){return{name:this._name,link:this._link}}setLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){this._likes?this._cardElement.querySelector(".card__like-button").classList.add("card__like-button_active"):this._cardElement.querySelector(".card__like-button").classList.remove("card__like-button_active")}_hideDeleteButton(){this._ownerId!==this._userId&&this._cardElement.querySelector(".card__delete-button").remove()}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeClick(this))),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick(this._getData())})),this._hideDeleteButton()}remove(){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}_fillCardTemplate(){const e=this._cardElement.querySelector(".card__image");e.alt=`Photo of ${this._name}`,e.src=this._link,this._cardElement.id=this.imageId,this._cardElement.querySelector(".card__title").textContent=this._name}getView(){return this._cardElement=this._getTemplate(),this._fillCardTemplate(),this._setEventListeners(),this._renderLikes(),this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}resetValidation(){this._inputList.forEach((e=>{const t=this._formElement.querySelector(`#${e.id}-error`);this._hideInputError(e,t)})),this._toggleButtonState()}_toggleButtonState(){if(this._hasInvalidInput())return this._buttonElement.classList.add(this._inactiveButtonClass),void(this._buttonElement.disabled=!0);this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_setEventListener(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__overlay")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends r{constructor(e){let{popupSelector:t,handleFormSubmit:s,loadingButtonText:r}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent,this._loadingButtonText=r}_getInputValues(){return this._newData={},this._inputList.forEach((e=>{this._newData[e.name]=e.value})),this._newData}setEventListener(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){this._popupForm.reset(),super.close()}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}}const o=document.querySelector("#profile-edit-button"),n=document.querySelector("#profile-add-button"),l=document.querySelector("#profile-edit-modal"),a=document.querySelector("#add-card-modal"),d=document.querySelector("#preview-modal"),c=(l.querySelector(".modal__close"),a.querySelector(".modal__close"),d.querySelector(".modal__close"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#edit-form-title")),u=document.querySelector("#edit-form-description"),_=l.querySelector(".modal__form"),h=a.querySelector(".modal__form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,h.querySelector(".modal__input_type_title"),h.querySelector(".modal__input_type_url"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-footer"),{inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"});let p,E;const S=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(`${this._url}/users/me`,{method:"GET",headers:this._headers}).then(this._processResponse)}getInitialCards(){return fetch(`${this._url}/cards`,{method:"GET",headers:this._headers}).then(this._processResponse)}editProfile(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._processResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._processResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}likeCard(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._processResponse)}unlikeCard(e){return fetch(`${this._url}/cards/${e}/likes/`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}updateProfilePicture(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.link})}).then(this._processResponse)}_processResponse=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"60e8627a-87a1-4754-957b-4e30882d5630","Content-Type":"application/json"}}),v=new class{constructor(e){let{nameSelector:t,professionSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._name.textContent=t,this._about.textContent=s,r&&(this._avatarElement.src=r)}}({nameSelector:".profile__title",professionSelector:".profile__description",avatarSelector:".profile__image"});function f(e){e._likes?S.unlikeCard(e._id).then((t=>{e.setLikes(t.isLiked)})).catch(console.error):S.likeCard(e._id).then((t=>{e.setLikes(t.isLiked)})).catch(console.error)}function y(e){g.open(e)}Promise.all([S.getUserInfo(),S.getInitialCards()]).then((e=>{let[t,r]=e;v.setUserInfo(t),p=t._id,v.setUserInfo(t),E=new s({items:r,renderer:e=>{let{name:t,link:s,isLiked:r,_id:i,userId:o,ownerId:n}=e;const l=k({name:t,link:s,isLiked:r,_id:i,userId:o,ownerId:n});E.addItem(l)}},".cards__list"),E.renderItems()})).catch(console.error);const L=new class extends r{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button")}setSubmitAction(e){this._handleSubmit=e}setLoading(e,t){this._submitButton.textContent=e?"Deleting...":t}setEventListeners(){super.setEventListeners(),this._submitButton.addEventListener("click",(()=>{this._handleSubmit()}))}}("#delete-card-modal");function b(e){L.open(),L.setSubmitAction((()=>{L.setLoading(!0),S.deleteCard(e.getId()).then((()=>{e.remove(),L.close()})).catch(console.error).finally((()=>{L.setLoading(!1,"Yes")}))}))}function k(t){let{name:s,link:r,isLiked:i,_id:o,userId:n,ownerId:l}=t;return new e({name:s,link:r,isLiked:i,_id:o,userId:n,ownerId:l},p,"#card-template",y,b,f).getView()}L.setEventListeners();const g=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._imageElement=this._popupElement.querySelector(".modal__preview-image"),this._footerElement=this._popupElement.querySelector(".modal__preview-footer")}open(e){let{link:t,name:s}=e;this._footerElement.textContent=s,this._imageElement.src=t,this._imageElement.alt=s,super.open()}}({popupSelector:"#preview-modal",handleFormSubmit:function(e){let{name:t,about:s}=e;newUser.setUserInfo(t,s),C.close()}});g.setEventListeners();const C=new i({popupSelector:"#profile-edit-modal",handleFormSubmit:e=>{C.showLoading(),S.editProfile(e).then((()=>{v.setUserInfo(e),C.close()})).catch(console.error).finally((()=>{C.hideLoading()}))},loadingButtonText:"Saving..."});C.setEventListener(),o.addEventListener("click",(()=>{const e=v.getUserInfo();c.value=e.name,u.value=e.about,C.open()}));const q=new t(m,h);q.enableValidation();const I=new t(m,_),w=new t(m,document.querySelector("#edit-avatar-modal").querySelector(".modal__form"));I.enableValidation(),w.enableValidation();const B=new i({popupSelector:"#add-card-modal",handleFormSubmit:e=>{B.showLoading(),S.addNewCard(e).then((e=>{const t=k(e);E.prependItem(t),B.close()})).catch(console.error).finally((()=>{B.hideLoading()}))},loadingButtonText:"Saving..."});B.close(),B.setEventListener(),n.addEventListener("click",(()=>{q.resetValidation(),B.open()}));const x=document.querySelector(".profile__image-overlay"),T=(document.querySelector("#profile-avatar"),new i({popupSelector:"#edit-avatar-modal",handleFormSubmit:e=>{T.showLoading(),S.updateProfilePicture(e).then((e=>{v.setUserInfo(e),T.close()})).catch(console.error).finally((()=>{T.hideLoading()}))},loadingButtonText:"Saving..."}));T.close(),T.setEventListener(),x.addEventListener("click",(()=>{w.resetValidation(),T.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJbkssRUFDNUIwRixFQUNBRixHQU1JNEUsRUFBc0IsSUFBSXBLLEVBQzlCMEYsRUFKc0JyRyxTQUFTUixjQUFjLHNCQUNSQSxjQUFjLGlCQU9yRHNMLEVBQWtCakksbUJBQ2xCa0ksRUFBb0JsSSxtQkFRcEIsTUFBTW1JLEVBQWUsSUFBSUwsRUFBYyxDQUNyQzdHLGNBQWUsa0JBQ2ZhLGlCQUFtQjJDLElBQ2pCMEQsRUFBYXRGLGNBQ2JlLEVBQ0drQixXQUFXTCxHQUNYSixNQUFNaUQsSUFDTCxNQUFNVCxFQUFVQyxFQUFXUSxHQUMzQjNELEVBQVMvQyxZQUFZaUcsR0FDckJzQixFQUFhN0csT0FBTyxJQUVyQitFLE1BQU1DLFFBQVFDLE9BQ2RnQixTQUFRLEtBQ1BZLEVBQWFyRixhQUFhLEdBQzFCLEVBRU5mLGtCQUFtQixjQUdyQm9HLEVBQWE3RyxRQUNiNkcsRUFBYXpGLG1CQUViTSxFQUFpQi9GLGlCQUFpQixTQUFTLEtBQ3pDK0ssRUFBaUIxSSxrQkFDakI2SSxFQUFhOUcsTUFBTSxJQU9yQixNQUFNK0csRUFBbUJqTCxTQUFTUixjQUFjLDJCQUcxQzBMLEdBRmdCbEwsU0FBU1IsY0FBYyxtQkFFckIsSUFBSW1MLEVBQWMsQ0FDeEM3RyxjQUFlLHFCQUNmYSxpQkFBbUIyQyxJQUNqQjRELEVBQWdCeEYsY0FDaEJlLEVBQ0d1QixxQkFBcUJWLEdBQ3JCSixNQUFNZ0IsSUFDTE8sRUFBU00sWUFBWWIsR0FDckJnRCxFQUFnQi9HLE9BQU8sSUFFeEIrRSxNQUFNQyxRQUFRQyxPQUNkZ0IsU0FBUSxLQUNQYyxFQUFnQnZGLGFBQWEsR0FDN0IsRUFFTmYsa0JBQW1CLGVBR3JCc0csRUFBZ0IvRyxRQUNoQitHLEVBQWdCM0YsbUJBRWhCMEYsRUFBaUJuTCxpQkFBaUIsU0FBUyxLQUN6Q2lMLEVBQW9CNUksa0JBQ3BCK0ksRUFBZ0JoSCxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluaywgaXNMaWtlZCwgX2lkLCB1c2VySWQsIG93bmVySWQgfSxcbiAgICBteUlkLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgIHRoaXMuX2xpa2VzID0gaXNMaWtlZDtcbiAgICB0aGlzLl9pZCA9IF9pZDtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5fb3duZXJJZCA9IG93bmVySWQ7XG4gICAgdGhpcy5fbXlJZCA9IG15SWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgfVxuXG4gIGdldElkKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIF9nZXREYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgbGluazogdGhpcy5fbGluayxcbiAgICB9O1xuICB9XG5cbiAgc2V0TGlrZXMoaXNMaWtlZCkge1xuICAgIHRoaXMuX2xpa2VzID0gaXNMaWtlZDtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGlmICh0aGlzLl9saWtlcykge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9oaWRlRGVsZXRlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKS5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpKTtcblxuICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX2dldERhdGEoKSk7XG4gICAgfSk7XG4gICAgdGhpcy5faGlkZURlbGV0ZUJ1dHRvbigpO1xuICB9XG5cbiAgcmVtb3ZlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfZmlsbENhcmRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIGNhcmRJbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQuaWQgPSB0aGlzLmltYWdlSWQ7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9maWxsQ2FyZFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBjb25maWcuZm9ybVNlbGVjdG9yO1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxuICAgICAgKTtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwsIGVycm9yTWVzc2FnZUVsKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXIoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcbiAgICBdO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVyKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjYXJkU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjYXJkU2VsZWN0b3IpO1xuICB9XG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XG4gIH1cblxuICBwcmVwZW5kSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZSkge1xuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19vdmVybGF5XCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRnJvbSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0LCBsb2FkaW5nQnV0dG9uVGV4dCB9KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX2J1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5fbG9hZGluZ0J1dHRvblRleHQgPSBsb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9uZXdEYXRhID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5fbmV3RGF0YVtpbnB1dEVsZW1lbnQubmFtZV0gPSBpbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX25ld0RhdGE7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVyKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cblxuICBzaG93TG9hZGluZygpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dDtcbiAgfVxuXG4gIGhpZGVMb2FkaW5nKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblRleHQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbiA9XG4gIHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPVxuICBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld01vZGFsQ2xvc2VCdXR0b24gPVxuICBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgbW9kYWxUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWZvcm0tdGl0bGVcIik7XG5leHBvcnQgY29uc3QgbW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjZWRpdC1mb3JtLWRlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiXG4pO1xuZXhwb3J0IGNvbnN0IGNhcmRVcmxJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfdXJsXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld0Zvb3RlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctZm9vdGVyXCIpO1xuXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICAvLyBpbml0aWFsQ2FyZHMsXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBwcm9maWxlQWRkQnV0dG9uLFxuICBwcm9maWxlRWRpdE1vZGFsLFxuICBhZGRDYXJkTW9kYWwsXG4gIHByZXZpZXdJbWFnZU1vZGFsLFxuICBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbixcbiAgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24sXG4gIHByZXZpZXdNb2RhbENsb3NlQnV0dG9uLFxuICBwcm9maWxlVGl0bGUsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgbW9kYWxUaXRsZUlucHV0LFxuICBtb2RhbERlc2NyaXB0aW9uSW5wdXQsXG4gIHByb2ZpbGVFZGl0Rm9ybSxcbiAgYWRkQ2FyZEZvcm0sXG4gIGNhcmRMaXN0RWwsXG4gIGNhcmRUZW1wbGF0ZSxcbiAgY2FyZFRpdGxlSW5wdXQsXG4gIGNhcmRVcmxJbnB1dCxcbiAgcHJldmlld0ltYWdlLFxuICBwcmV2aWV3Rm9vdGVyLFxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBUEkgKyB1c2VySW5mb1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxubGV0IHVzZXJJRDtcbmxldCBjYXJkTGlzdDtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNjBlODYyN2EtODdhMS00NzU0LTk1N2ItNGUzMDg4MmQ1NjMwXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHByb2Zlc3Npb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAudGhlbigoW3VzZXIsIGluaXRpYWxDYXJkc10pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcbiAgICB1c2VySUQgPSB1c2VyLl9pZDtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcblxuICAgIGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoeyBuYW1lLCBsaW5rLCBpc0xpa2VkLCBfaWQsIHVzZXJJZCwgb3duZXJJZCB9KSA9PiB7XG4gICAgICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoe1xuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIGxpbmssXG4gICAgICAgICAgICBpc0xpa2VkLFxuICAgICAgICAgICAgX2lkLFxuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgb3duZXJJZCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKG5ld0NhcmQpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcbiAgICApO1xuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEhhbmRsZSBDbGlja3Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkSW5zdGFuY2UpIHtcbiAgaWYgKGNhcmRJbnN0YW5jZS5fbGlrZXMpIHtcbiAgICBhcGlcbiAgICAgIC51bmxpa2VDYXJkKGNhcmRJbnN0YW5jZS5faWQpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmRJbnN0YW5jZS5zZXRMaWtlcyhyZXMuaXNMaWtlZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICB9IGVsc2Uge1xuICAgIGFwaVxuICAgICAgLmxpa2VDYXJkKGNhcmRJbnN0YW5jZS5faWQpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmRJbnN0YW5jZS5zZXRMaWtlcyhyZXMuaXNMaWtlZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhkYXRhKSB7XG4gIHByZXZpZXdJbWFnZVBvcHVwLm9wZW4oZGF0YSk7XG59XG5cbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZCkge1xuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICBkZWxldGVDYXJkUG9wdXAuc2V0TG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5yZW1vdmUoKTtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRMb2FkaW5nKGZhbHNlLCBcIlllc1wiKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZCh7IG5hbWUsIGxpbmssIGlzTGlrZWQsIF9pZCwgdXNlcklkLCBvd25lcklkIH0pIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChcbiAgICB7IG5hbWUsIGxpbmssIGlzTGlrZWQsIF9pZCwgdXNlcklkLCBvd25lcklkIH0sXG4gICAgdXNlcklELFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XG59XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUHJldmlldyBQb3B1cFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgcHJldmlld0ltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3LW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0LFxufSk7XG5wcmV2aWV3SW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUHJvZmlsZSBQb3B1cFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoeyBuYW1lLCBhYm91dCB9KSB7XG4gIG5ld1VzZXIuc2V0VXNlckluZm8obmFtZSwgYWJvdXQpO1xuICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcbn1cblxuY29uc3QgcHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgcHJvZmlsZVBvcHVwLnNob3dMb2FkaW5nKCk7XG4gICAgYXBpXG4gICAgICAuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGlucHV0VmFsdWVzKTtcbiAgICAgICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHByb2ZpbGVQb3B1cC5oaWRlTG9hZGluZygpO1xuICAgICAgfSk7XG4gIH0sXG4gIGxvYWRpbmdCdXR0b25UZXh0OiBcIlNhdmluZy4uLlwiLFxufSk7XG5cbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVyKCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgbW9kYWxUaXRsZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgbW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuYWJvdXQ7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFZhbGlkYXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtVmFsaWRhdGlvbkNvbmZpZywgYWRkQ2FyZEZvcm0pO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxuICBwcm9maWxlRWRpdEZvcm1cbik7XG5cbmNvbnN0IGF2YXRhckVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItbW9kYWxcIik7XG5jb25zdCBhdmF0YXJFZGl0Rm9ybSA9IGF2YXRhckVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuXG5jb25zdCBlZGl0QXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxuICBhdmF0YXJFZGl0Rm9ybVxuKTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmV4cG9ydCB7IHByZXZpZXdJbWFnZSwgcHJldmlld0Zvb3RlciwgcHJldmlld0ltYWdlTW9kYWwgfTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFkZCBDYXJkIFBvcHVwXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgIGFkZENhcmRQb3B1cC5zaG93TG9hZGluZygpO1xuICAgIGFwaVxuICAgICAgLmFkZE5ld0NhcmQoaW5wdXRWYWx1ZXMpXG4gICAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRlQ2FyZChjYXJkKTtcbiAgICAgICAgY2FyZExpc3QucHJlcGVuZEl0ZW0obmV3Q2FyZCk7XG4gICAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBhZGRDYXJkUG9wdXAuaGlkZUxvYWRpbmcoKTtcbiAgICAgIH0pO1xuICB9LFxuICBsb2FkaW5nQnV0dG9uVGV4dDogXCJTYXZpbmcuLi5cIixcbn0pO1xuXG5hZGRDYXJkUG9wdXAuY2xvc2UoKTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVyKCk7XG5cbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUHJvZmlsZSBBdmF0YXJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLW92ZXJsYXlcIik7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhclwiKTtcblxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNlZGl0LWF2YXRhci1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgICBlZGl0QXZhdGFyUG9wdXAuc2hvd0xvYWRpbmcoKTtcbiAgICBhcGlcbiAgICAgIC51cGRhdGVQcm9maWxlUGljdHVyZShpbnB1dFZhbHVlcylcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcbiAgICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGVkaXRBdmF0YXJQb3B1cC5oaWRlTG9hZGluZygpO1xuICAgICAgfSk7XG4gIH0sXG4gIGxvYWRpbmdCdXR0b25UZXh0OiBcIlNhdmluZy4uLlwiLFxufSk7XG5cbmVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xuZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXIoKTtcblxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0QXZhdGFyVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBlZGl0QXZhdGFyUG9wdXAub3BlbigpO1xufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBlZGl0UHJvZmlsZShpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgICBhYm91dDogaW5wdXRWYWx1ZXMuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSUR9L2xpa2VzL2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUoaW5wdXRWYWx1ZXMpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogaW5wdXRWYWx1ZXMubGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIF9wcm9jZXNzUmVzcG9uc2UgPSAocmVzKSA9PiB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIHByb2Zlc3Npb25TZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2Zlc3Npb25TZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0LCBhdmF0YXIgfSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gICAgaWYgKGF2YXRhcikge1xuICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oY2FsbEJhY2spIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBjYWxsQmFjaztcbiAgfVxuXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nLCBvcmlnaW5hbFRleHQpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgdGhpcy5fZm9vdGVyRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWZvb3RlclwiKTtcbiAgfVxuXG4gIG9wZW4oeyBsaW5rLCBuYW1lIH0pIHtcbiAgICB0aGlzLl9mb290ZXJFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwibXlJZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJpc0xpa2VkIiwiX2lkIiwidXNlcklkIiwib3duZXJJZCIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VzIiwiX3VzZXJJZCIsIl9vd25lcklkIiwiX215SWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJnZXRJZCIsIl9nZXREYXRhIiwic2V0TGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiX2hpZGVEZWxldGVCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2ZpbGxDYXJkVGVtcGxhdGUiLCJjYXJkSW1hZ2UiLCJhbHQiLCJzcmMiLCJpZCIsImltYWdlSWQiLCJ0ZXh0Q29udGVudCIsImdldFZpZXciLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInJlc2V0VmFsaWRhdGlvbiIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJldmVyeSIsIl9zZXRFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsImFwcGVuZCIsInByZXBlbmRJdGVtIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGcm9tIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImxvYWRpbmdCdXR0b25UZXh0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2J1dHRvblRleHQiLCJfbG9hZGluZ0J1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfbmV3RGF0YSIsImlucHV0RWxlbWVudCIsInZhbHVlIiwic2V0RXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVzZXQiLCJzaG93TG9hZGluZyIsImhpZGVMb2FkaW5nIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsInByZXZpZXdJbWFnZU1vZGFsIiwibW9kYWxUaXRsZUlucHV0IiwibW9kYWxEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm0iLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImZpcnN0RWxlbWVudENoaWxkIiwidXNlcklEIiwiY2FyZExpc3QiLCJhcGkiLCJvcHRpb25zIiwiX3VybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsIl9wcm9jZXNzUmVzcG9uc2UiLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0UHJvZmlsZSIsImlucHV0VmFsdWVzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJkZWxldGVDYXJkIiwiY2FyZElEIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwidXBkYXRlUHJvZmlsZVBpY3R1cmUiLCJhdmF0YXIiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwicHJvZmVzc2lvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfYWJvdXQiLCJfYXZhdGFyRWxlbWVudCIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJjYXJkSW5zdGFuY2UiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImRhdGEiLCJwcmV2aWV3SW1hZ2VQb3B1cCIsImFsbCIsInVzZXIiLCJpbml0aWFsQ2FyZHMiLCJuZXdDYXJkIiwiY3JlYXRlQ2FyZCIsImRlbGV0ZUNhcmRQb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImNhbGxCYWNrIiwiX2hhbmRsZVN1Ym1pdCIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJvcmlnaW5hbFRleHQiLCJjYXJkIiwiZmluYWxseSIsIl9yZWYzIiwiX2ltYWdlRWxlbWVudCIsIl9mb290ZXJFbGVtZW50IiwiX3JlZjQiLCJuZXdVc2VyIiwicHJvZmlsZVBvcHVwIiwiUG9wdXBXaXRoRm9ybSIsInVzZXJEYXRhIiwiYWRkRm9ybVZhbGlkYXRvciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiZWRpdEF2YXRhclZhbGlkYXRvciIsImFkZENhcmRQb3B1cCIsImF2YXRhckVkaXRCdXR0b24iLCJlZGl0QXZhdGFyUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9