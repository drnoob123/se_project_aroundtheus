!function(){"use strict";class e{constructor(e,t,s,i,n,o){let{name:r,link:a}=e;this._name=r,this._link=a,this._isLiked=!1,this._cardSelector=s,this._handleCardClick=i,this._handleDeleteClick=n,this._handleLikeClick=o}toggleLike(){this._isLiked=!this._isLiked,this._updateLikeState()}_updateLikeState(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeClick(this))),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}removeCard(){this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_initializeCardFields(){this._cardImage=this._cardElement.querySelector(".card__image"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardTitle=this._cardElement.querySelector(".card__title")}_fillCardTemplate(){this._cardImage.alt=`Photo of ${this._name}`,this._cardImage.src=this._link,this._cardTitle.textContent=this._name}getView(){return this._cardElement=this._getTemplate(),this._initializeCardFields(),this._fillCardTemplate(),this._setEventListeners(),this._updateLikeState(),this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}resetValidation(){this._inputList.forEach((e=>{const t=this._formElement.querySelector(`#${e.id}-error`);this._hideInputError(e,t)})),this._toggleButtonState()}_toggleButtonState(){if(this._hasInvalidInput())return this._buttonElement.classList.add(this._inactiveButtonClass),void(this._buttonElement.disabled=!0);this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_setEventListener(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__overlay")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(e){let{popupSelector:t,handleFormSubmit:s,loadingButtonText:i}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent}_getInputValues(){return this._newData={},this._inputList.forEach((e=>{this._newData[e.name]=e.value})),this._newData}setEventListener(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._resetForm()}))}_resetForm(){this._popupForm.reset()}}const n=document.querySelector("#profile-edit-button"),o=document.querySelector("#profile-add-button"),r=document.querySelector("#profile-edit-modal"),a=document.querySelector("#add-card-modal"),l=document.querySelector("#preview-modal"),c=(r.querySelector(".modal__close"),a.querySelector(".modal__close"),l.querySelector(".modal__close"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#edit-form-title")),u=document.querySelector("#edit-form-description"),_=r.querySelector(".modal__form"),d=a.querySelector(".modal__form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,d.querySelector(".modal__input_type_title"),d.querySelector(".modal__input_type_url"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-footer"),{inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}),h=new class{constructor(e){let{nameSelector:t,professionSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._avatarElement=document.querySelector(i)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s,avatar:i}=e;this._name.textContent=t,this._about.textContent=s,i&&(this._avatarElement.src=i)}}({nameSelector:".profile__title",professionSelector:".profile__description",avatarSelector:".profile__image"}),p=new class{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{let{name:t,link:s}=e;const i=f({name:t,link:s});p.addItem(i)}},".cards__list");function S(e){L.open(e)}function E(e){e.removeCard()}function v(e){e.toggleLike()}function f(t){let{name:s,link:i}=t;return new e({name:s,link:i},null,"#card-template",S,E,v).getView()}p.renderItems();const L=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._imageElement=this._popupElement.querySelector(".modal__preview-image"),this._footerElement=this._popupElement.querySelector(".modal__preview-footer")}open(e){let{link:t,name:s}=e;this._footerElement.textContent=s,this._imageElement.src=t,this._imageElement.alt=s,super.open()}}({popupSelector:"#preview-modal"});L.setEventListeners();const y=new i({popupSelector:"#profile-edit-modal",handleFormSubmit:e=>{h.setUserInfo(e),y.close()}});y.setEventListener(),n.addEventListener("click",(()=>{const e=h.getUserInfo();c.value=e.name,u.value=e.about,g.resetValidation(),y.open()}));const k=new t(m,d);k.enableValidation();const g=new t(m,_);g.enableValidation();const C=new i({popupSelector:"#add-card-modal",handleFormSubmit:e=>{const t=f(e);p.prependItem(t),C.close()},loadingButtonText:"Saving..."});C.setEventListener(),o.addEventListener("click",(()=>{k.resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixNQUFNK0UsRUFBZSxJQUFJL0QsRUFBYyxDQUNyQ1osY0FBZSxrQkFDZmEsaUJBQW1CMEQsSUFDakIsTUFBTVIsRUFBVUMsRUFBV08sR0FDM0JyQixFQUFTUyxZQUFZSSxHQUNyQlksRUFBYXRFLE9BQU8sRUFFdEJTLGtCQUFtQixjQUdyQjZELEVBQWFuRCxtQkFFYkssRUFBaUJyRixpQkFBaUIsU0FBUyxLQUN6Q2tJLEVBQWlCeEYsa0JBQ2pCeUYsRUFBYXZFLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluayB9LFxuICAgIHVzZXJJZCxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9pc0xpa2VkID0gZmFsc2U7IC8vIEluaXRpYWxpemUgdGhlIGxpa2Ugc3RhdGVcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgdG9nZ2xlTGlrZSgpIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gIXRoaXMuX2lzTGlrZWQ7IC8vIFRvZ2dsZSB0aGUgbGlrZSBzdGF0ZVxuICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0ZSgpO1xuICB9XG5cbiAgX3VwZGF0ZUxpa2VTdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpOyAvLyBQYXNzIHRoZSBjYXJkIGluc3RhbmNlIHRvIHRoZSBkZWxldGUgaGFuZGxlclxuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTsgLy8gUmVtb3ZlIHRoZSBjYXJkJ3MgRE9NIGVsZW1lbnRcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7IC8vIENsZWFuIHVwIHRoZSByZWZlcmVuY2VcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgX2luaXRpYWxpemVDYXJkRmllbGRzKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIH1cblxuICBfZmlsbENhcmRUZW1wbGF0ZSgpIHtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9pbml0aWFsaXplQ2FyZEZpZWxkcygpOyAvLyBTZXQgdXAgYWxsIGNhcmQtcmVsYXRlZCBlbGVtZW50cyBhcyBjbGFzcyBmaWVsZHNcbiAgICB0aGlzLl9maWxsQ2FyZFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl91cGRhdGVMaWtlU3RhdGUoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gY29uZmlnLmZvcm1TZWxlY3RvcjtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWwuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcbiAgICAgICk7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsLCBlcnJvck1lc3NhZ2VFbCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiAhdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVyKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IFtcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShlKSB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX292ZXJsYXlcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdCdXR0b25UZXh0IH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9uZXdEYXRhID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5fbmV3RGF0YVtpbnB1dEVsZW1lbnQubmFtZV0gPSBpbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX25ld0RhdGE7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVyKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuX3Jlc2V0Rm9ybSgpOyAvLyBSZXNldCB0aGUgZm9ybSBvbmx5IGFmdGVyIHN1Ym1pc3Npb25cbiAgICB9KTtcbiAgfVxuXG4gIF9yZXNldEZvcm0oKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7IC8vIENsZWFycyB0aGUgaW5wdXQgZmllbGRzXG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbiA9XG4gIHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPVxuICBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld01vZGFsQ2xvc2VCdXR0b24gPVxuICBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgbW9kYWxUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWZvcm0tdGl0bGVcIik7XG5leHBvcnQgY29uc3QgbW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjZWRpdC1mb3JtLWRlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGRDYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiXG4pO1xuZXhwb3J0IGNvbnN0IGNhcmRVcmxJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0X3R5cGVfdXJsXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcHJldmlld0Zvb3RlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctZm9vdGVyXCIpO1xuXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBwcm9maWxlQWRkQnV0dG9uLFxuICBtb2RhbFRpdGxlSW5wdXQsXG4gIG1vZGFsRGVzY3JpcHRpb25JbnB1dCxcbiAgcHJvZmlsZUVkaXRGb3JtLFxuICBhZGRDYXJkRm9ybSxcbiAgZm9ybVZhbGlkYXRpb25Db25maWcsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFVzZXIgSW5mb1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHByb2Zlc3Npb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENhcmQgU2VjdGlvblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICAgICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoeyBuYW1lLCBsaW5rIH0pO1xuICAgICAgY2FyZExpc3QuYWRkSXRlbShuZXdDYXJkKTtcbiAgICB9LFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG5jYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSGFuZGxlIENsaWNrc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGRhdGEpIHtcbiAgcHJldmlld0ltYWdlUG9wdXAub3BlbihkYXRhKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZEluc3RhbmNlKSB7XG4gIGNhcmRJbnN0YW5jZS5yZW1vdmVDYXJkKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkSW5zdGFuY2UpIHtcbiAgY2FyZEluc3RhbmNlLnRvZ2dsZUxpa2UoKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxuICAgIHsgbmFtZSwgbGluayB9LFxuICAgIG51bGwsIC8vIG5vIHVzZXIgSUQgcmVxdWlyZWQgaW4gdGhpcyBjb250ZXh0XG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFByZXZpZXcgUG9wdXBcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IHByZXZpZXdJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJldmlldy1tb2RhbFwiLFxufSk7XG5wcmV2aWV3SW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUHJvZmlsZSBQb3B1cFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoeyBuYW1lLCBhYm91dCB9KSB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5hbWUsIGFib3V0KTtcbiAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XG59XG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGlucHV0VmFsdWVzKTtcbiAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgfVxufSk7XG5cbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVyKCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgbW9kYWxUaXRsZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgbW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuYWJvdXQ7XG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpOyAvLyBDbGVhciB2YWxpZGF0aW9uIGVycm9ycyBiZWZvcmUgb3BlbmluZ1xuICBwcm9maWxlUG9wdXAub3BlbigpO1xufSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBWYWxpZGF0aW9uXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRpb25Db25maWcsIGFkZENhcmRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcbiAgcHJvZmlsZUVkaXRGb3JtXG4pO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQWRkIENhcmQgUG9wdXBcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoaW5wdXRWYWx1ZXMpO1xuICAgIGNhcmRMaXN0LnByZXBlbmRJdGVtKG5ld0NhcmQpO1xuICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuICB9LFxuICBsb2FkaW5nQnV0dG9uVGV4dDogXCJTYXZpbmcuLi5cIixcbn0pO1xuXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcigpO1xuXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7IC8vIENsZWFyIHZhbGlkYXRpb24gZXJyb3JzIGJlZm9yZSBvcGVuaW5nXG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIHByb2Zlc3Npb25TZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2Zlc3Npb25TZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0LCBhdmF0YXIgfSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gICAgaWYgKGF2YXRhcikge1xuICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2FyZFNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFNlbGVjdG9yKTtcbiAgfVxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XG4gICAgdGhpcy5fZm9vdGVyRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWZvb3RlclwiKTtcbiAgfVxuXG4gIG9wZW4oeyBsaW5rLCBuYW1lIH0pIHtcbiAgICB0aGlzLl9mb290ZXJFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwidXNlcklkIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJuYW1lIiwibGluayIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2lzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJ0b2dnbGVMaWtlIiwiX3VwZGF0ZUxpa2VTdGF0ZSIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlIiwicmVtb3ZlQ2FyZCIsIl9jYXJkRWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaW5pdGlhbGl6ZUNhcmRGaWVsZHMiLCJfY2FyZFRpdGxlIiwiX2ZpbGxDYXJkVGVtcGxhdGUiLCJhbHQiLCJzcmMiLCJ0ZXh0Q29udGVudCIsImdldFZpZXciLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwicmVzZXRWYWxpZGF0aW9uIiwiX2lucHV0TGlzdCIsImZvckVhY2giLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX2J1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsImV2ZXJ5IiwiX3NldEV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImxvYWRpbmdCdXR0b25UZXh0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2J1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfbmV3RGF0YSIsImlucHV0RWxlbWVudCIsInZhbHVlIiwic2V0RXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiX3Jlc2V0Rm9ybSIsInJlc2V0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsInByZXZpZXdJbWFnZU1vZGFsIiwibW9kYWxUaXRsZUlucHV0IiwibW9kYWxEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm0iLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImZpcnN0RWxlbWVudENoaWxkIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJwcm9mZXNzaW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9hYm91dCIsIl9hdmF0YXJFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJhYm91dCIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJhdmF0YXIiLCJjYXJkTGlzdCIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJuZXdDYXJkIiwiY3JlYXRlQ2FyZCIsImRhdGEiLCJwcmV2aWV3SW1hZ2VQb3B1cCIsImNhcmRJbnN0YW5jZSIsIl9pbWFnZUVsZW1lbnQiLCJfZm9vdGVyRWxlbWVudCIsInByb2ZpbGVQb3B1cCIsImlucHV0VmFsdWVzIiwidXNlckRhdGEiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9